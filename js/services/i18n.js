(() => {
const translations = {
  en: {
    dashboard: "Dashboard",
    patients: "Patients",
    doctors: "Doctors",
    services: "Services",
    appointments: "Appointments",
    prescriptions: "Prescriptions",
    logout: "Logout",
    hospital: "Hospital",
    backoffice: "Backoffice",
    reset: "Reset",
    search: "Search...",
    export: "Export",
    add: "Add",
    firstName: "First Name",
    lastName: "Last Name",
    email: "Email",
    phone: "Phone",
    bloodGroup: "Blood Group",
    actions: "Actions",
    view: "View",
    edit: "Edit",
    delete: "Delete",
    noPatients: "No patients found.",
    showing: "Showing",
    to: "to",
    of: "of",
    addPatient: "Add Patient",
    editPatient: "Edit Patient",
    save: "Save",
    cancel: "Cancel",
    patientDetails: "Patient Details",
    exportCSV: "Export CSV",
    exportPDF: "Export PDF",
    generatedOn: "Generated on",
    pdfLibNotLoaded: "PDF export libraries are not loaded.",
    exportNotAvailable: "Export not available",
    welcome: "Welcome back",
    signIn: "Sign in to access the dashboard",
    username: "Username",
    password: "Password",
    login: "Login",
    demo: "Demo: admin / admin",
    patientsByService: "Patients by service",
    appointmentsByDay: "Appointments by day",
    appointmentsEvolution: "Appointments evolution (last 7 days)",
    appointmentsByStatus: "Appointments by status",
    doctorsBySpecialty: "Doctors by specialty",
    totalPatients: "Total patients",
    totalDoctors: "Total doctors",
    totalAppointments: "Total appointments",
    totalServices: "Total services",
    totalPrescriptions: "Total prescriptions",
    scheduled: "Scheduled",
    completed: "Completed",
    cancelled: "Cancelled",
    dateOfBirth: "Date of Birth",
    gender: "Gender",
    address: "Address",
    service: "Service",
    selectService: "Select a service",
    male: "Male",
    female: "Female",
    fullName: "Full Name",
    confirmDelete: "Are you sure you want to delete this patient?",
    confirmDeleteDoctor: "Are you sure you want to delete this doctor?",
    confirmDeleteService: "Are you sure you want to delete this service?",
    confirmDeleteAppointment: "Are you sure you want to delete this appointment?",
    confirmDeletePrescription: "Are you sure you want to delete this prescription?",
    specialty: "Specialty",
    noDoctors: "No doctors found.",
    name: "Name",
    description: "Description",
    noServices: "No services found.",
    date: "Date",
    time: "Time",
    status: "Status",
    patient: "Patient",
    doctor: "Doctor",
    noAppointments: "No appointments found.",
    medications: "Medications",
    dosage: "Dosage",
    dose: "Dose",
    noPrescriptions: "No prescriptions found.",
    unknown: "Unknown",
    all: "All",
    selectDoctor: "Select Doctor",
    selectPatient: "Select Patient",
    entries: "entries",
    previous: "Previous",
    next: "Next",
    filter: "Filter",
    details: "Details",
    close: "Close",
    confirm: "Confirm",
    noData: "No data available",
    total: "Total",
    fillAllFields: "Please fill all fields",
    createdSuccessfully: "Created successfully",
    updatedSuccessfully: "Updated successfully",
    deletedSuccessfully: "Deleted successfully",
    deleteFailed: "Delete failed",
    addDoctor: "Add Doctor",
    addAppointment: "Add Appointment",
    addService: "Add Service",
    addPrescription: "Add Prescription",
    editDoctor: "Edit Doctor",
    editAppointment: "Edit Appointment",
    editService: "Edit Service",
    editPrescription: "Edit Prescription",
    doctorDetails: "Doctor Details",
    appointmentDetails: "Appointment Details",
    serviceDetails: "Service Details",
    prescriptionDetails: "Prescription Details",
    personalInformation: "Personal Information",
    professionalInformation: "Professional Information",
    contactInformation: "Contact Information",
    serviceInformation: "Service Information",
    appointmentInformation: "Appointment Information",
    prescriptionInformation: "Prescription Information",
    participants: "Participants",
    statistics: "Statistics",
    registrationDate: "Registration Date",
    lastAppointment: "Last Appointment",
    upcoming: "Upcoming",
    headDoctor: "Head Doctor",
    dashboardReport: "Dashboard Report",
    keyMetrics: "Key Metrics",
    topServices: "Top Services",
    topSpecialties: "Top Specialties",
    duration: "Duration",
    id: "ID"
  },
  fr: {
    dashboard: "Tableau de bord",
    patients: "Patients",
    doctors: "Médecins",
    services: "Services",
    appointments: "Rendez-vous",
    prescriptions: "Ordonnances",
    logout: "Déconnexion",
    hospital: "Hôpital",
    backoffice: "Administration",
    reset: "Réinitialiser",
    search: "Rechercher...",
    export: "Exporter",
    add: "Ajouter",
    firstName: "Prénom",
    lastName: "Nom",
    email: "Email",
    phone: "Téléphone",
    bloodGroup: "Groupe Sanguin",
    actions: "Actions",
    view: "Voir",
    edit: "Modifier",
    delete: "Supprimer",
    noPatients: "Aucun patient trouvé.",
    showing: "Affichage de",
    to: "à",
    of: "sur",
    addPatient: "Ajouter un patient",
    editPatient: "Modifier le patient",
    save: "Enregistrer",
    cancel: "Annuler",
    patientDetails: "Détails du patient",
    exportCSV: "Exporter CSV",
    exportPDF: "Exporter PDF",
    generatedOn: "Généré le",
    pdfLibNotLoaded: "Les bibliothèques d'export PDF ne sont pas chargées.",
    exportNotAvailable: "Export non disponible",
    welcome: "Bon retour",
    signIn: "Connectez-vous pour accéder au tableau de bord",
    username: "Nom d'utilisateur",
    password: "Mot de passe",
    login: "Connexion",
    demo: "Démo: admin / admin",
    patientsByService: "Patients par service",
    appointmentsByDay: "Rendez-vous par jour",
    appointmentsEvolution: "Évolution des rendez-vous (7 derniers jours)",
    appointmentsByStatus: "Rendez-vous par statut",
    doctorsBySpecialty: "Médecins par spécialité",
    totalPatients: "Total patients",
    totalDoctors: "Total médecins",
    totalAppointments: "Total rendez-vous",
    totalServices: "Total services",
    totalPrescriptions: "Total ordonnances",
    scheduled: "Planifié",
    completed: "Terminé",
    cancelled: "Annulé",
    dateOfBirth: "Date de naissance",
    gender: "Genre",
    address: "Adresse",
    service: "Service",
    selectService: "Sélectionnez un service",
    male: "Homme",
    female: "Femme",
    fullName: "Nom complet",
    confirmDelete: "Êtes-vous sûr de vouloir supprimer ce patient ?",
    specialty: "Spécialité",
    noDoctors: "Aucun médecin trouvé.",
    name: "Nom",
    description: "Description",
    noServices: "Aucun service trouvé.",
    date: "Date",
    time: "Heure",
    status: "Statut",
    patient: "Patient",
    doctor: "Médecin",
    noAppointments: "Aucun rendez-vous trouvé.",
    medications: "Médicaments",
    dosage: "Dosage",
    noPrescriptions: "Aucune ordonnance trouvée.",
    unknown: "Inconnu",
    addDoctor: "Ajouter un médecin",
    editDoctor: "Modifier le médecin",
    doctorDetails: "Détails du médecin",
    addService: "Ajouter un service",
    editService: "Modifier le service",
    serviceDetails: "Détails du service",
    addAppointment: "Ajouter un rendez-vous",
    editAppointment: "Modifier le rendez-vous",
    appointmentDetails: "Détails du rendez-vous",
    addPrescription: "Ajouter une ordonnance",
    editPrescription: "Modifier l'ordonnance",
    prescriptionDetails: "Détails de l'ordonnance",
    selectDoctor: "Sélectionnez un médecin",
    selectPatient: "Sélectionnez un patient",
    dosage: "Dosage",
    dose: "Dose",
    duration: "Durée",
    prescriptionDate: "Date",
    confirmDeleteDoctor: "Êtes-vous sûr de vouloir supprimer ce médecin ?",
    confirmDeleteService: "Êtes-vous sûr de vouloir supprimer ce service ?",
    confirmDeleteAppointment: "Êtes-vous sûr de vouloir supprimer ce rendez-vous ?",
    confirmDeletePrescription: "Êtes-vous sûr de vouloir supprimer cette ordonnance ?",
    createdSuccessfully: "Créé avec succès",
    updatedSuccessfully: "Mis à jour avec succès",
    deletedSuccessfully: "Supprimé avec succès",
    deleteFailed: "Échec de suppression",
    entries: "entrées",
    previous: "Précédent",
    next: "Suivant",
    filter: "Filtrer",
    details: "Détails",
    close: "Fermer",
    confirm: "Confirmer",
    noData: "Aucune donnée disponible",
    total: "Total",
    recentAppointments: "Rendez-vous récents",
    cardiology: "Cardiologie",
    neurology: "Neurologie",
    pediatrics: "Pédiatrie",
    orthopedics: "Orthopédie",
    dermatology: "Dermatologie",
    generalMedicine: "Médecine Générale",
    surgery: "Chirurgie",
    oncology: "Oncologie",
    all: "Tout",
    fillAllFields: "Veuillez remplir tous les champs",
    personalInformation: "Informations personnelles",
    professionalInformation: "Informations professionnelles",
    contactInformation: "Informations de contact",
    serviceInformation: "Informations du service",
    appointmentInformation: "Informations du rendez-vous",
    prescriptionInformation: "Informations de l'ordonnance",
    participants: "Participants",
    statistics: "Statistiques",
    registrationDate: "Date d'inscription",
    lastAppointment: "Dernier rendez-vous",
    upcoming: "À venir",
    headDoctor: "Chef de service",
    dashboardReport: "Rapport du tableau de bord",
    keyMetrics: "Indicateurs clés",
    topServices: "Top services",
    topSpecialties: "Top spécialités",
    id: "ID"
  },
  ar: {
    dashboard: "لوحة القيادة",
    patients: "المرضى",
    doctors: "الأطباء",
    services: "الخدمات",
    appointments: "المواعيد",
    prescriptions: "الوصفات الطبية",
    logout: "تسجيل الخروج",
    hospital: "مستشفى",
    backoffice: "الإدارة",
    reset: "إعادة تعيين",
    search: "بحث...",
    export: "تصدير",
    add: "إضافة",
    firstName: "الاسم الأول",
    lastName: "اسم العائلة",
    email: "البريد الإلكتروني",
    phone: "الهاتف",
    bloodGroup: "فصيلة الدم",
    actions: "إجراءات",
    view: "عرض",
    edit: "تعديل",
    delete: "حذف",
    noPatients: "لم يتم العثور على مرضى.",
    showing: "عرض",
    to: "إلى",
    of: "من",
    addPatient: "إضافة مريض",
    editPatient: "تعديل مريض",
    save: "حفظ",
    cancel: "إلغاء",
    patientDetails: "تفاصيل المريض",
    exportCSV: "تصدير CSV",
    exportPDF: "تصدير PDF",
    generatedOn: "تم الإنشاء في",
    pdfLibNotLoaded: "مكتبات تصدير PDF غير محمّلة.",
    exportNotAvailable: "التصدير غير متاح",
    welcome: "مرحباً بعودتك",
    signIn: "سجل الدخول للوصول إلى لوحة القيادة",
    username: "اسم المستخدم",
    password: "كلمة المرور",
    login: "تسجيل الدخول",
    demo: "عرض تجريبي: admin / admin",
    patientsByService: "المرضى حسب الخدمة",
    appointmentsByDay: "المواعيد حسب اليوم",
    appointmentsEvolution: "تطور المواعيد (آخر 7 أيام)",
    appointmentsByStatus: "المواعيد حسب الحالة",
    doctorsBySpecialty: "الأطباء حسب التخصص",
    totalPatients: "إجمالي المرضى",
    totalDoctors: "إجمالي الأطباء",
    totalAppointments: "إجمالي المواعيد",
    totalServices: "إجمالي الخدمات",
    totalPrescriptions: "إجمالي الوصفات الطبية",
    scheduled: "مجدول",
    completed: "مكتمل",
    cancelled: "ملغى",
    dateOfBirth: "تاريخ الميلاد",
    gender: "النوع",
    address: "العنوان",
    service: "الخدمة",
    selectService: "اختر خدمة",
    male: "ذكر",
    female: "أنثى",
    fullName: "الاسم الكامل",
    confirmDelete: "هل أنت متأكد أنك تريد حذف هذا المريض؟",
    specialty: "التخصص",
    noDoctors: "لم يتم العثور على أطباء.",
    name: "الاسم",
    description: "الوصف",
    noServices: "لم يتم العثور على خدمات.",
    date: "التاريخ",
    time: "الوقت",
    status: "الحالة",
    patient: "المريض",
    doctor: "الطبيب",
    noAppointments: "لم يتم العثور على مواعيد.",
    medications: "الأدوية",
    noPrescriptions: "لم يتم العثور على وصفات طبية.",
    unknown: "غير معروف",
    addDoctor: "إضافة طبيب",
    editDoctor: "تعديل الطبيب",
    doctorDetails: "تفاصيل الطبيب",
    addService: "إضافة خدمة",
    editService: "تعديل الخدمة",
    serviceDetails: "تفاصيل الخدمة",
    addAppointment: "إضافة موعد",
    editAppointment: "تعديل الموعد",
    appointmentDetails: "تفاصيل الموعد",
    addPrescription: "إضافة وصفة طبية",
    editPrescription: "تعديل الوصفة الطبية",
    prescriptionDetails: "تفاصيل الوصفة الطبية",
    selectDoctor: "اختر طبيب",
    selectPatient: "اختر مريض",
    dosage: "الجرعة",
    duration: "المدة",
    prescriptionDate: "التاريخ",
    confirmDeleteDoctor: "هل أنت متأكد أنك تريد حذف هذا الطبيب؟",
    confirmDeleteService: "هل أنت متأكد أنك تريد حذف هذه الخدمة؟",
    confirmDeleteAppointment: "هل أنت متأكد أنك تريد حذف هذا الموعد؟",
    confirmDeletePrescription: "هل أنت متأكد أنك تريد حذف هذه الوصفة الطبية؟",
    createdSuccessfully: "تمت الإضافة بنجاح",
    updatedSuccessfully: "تم التحديث بنجاح",
    deletedSuccessfully: "تم الحذف بنجاح",
    deleteFailed: "فشل الحذف",
    entries: "سجلات",
    previous: "السابق",
    next: "التالي",
    filter: "تصفية",
    details: "تفاصيل",
    close: "إغلاق",
    confirm: "تأكيد",
    noData: "لا توجد بيانات",
    total: "المجموع",
    recentAppointments: "المواعيد الأخيرة",
    cardiology: "أمراض القلب",
    neurology: "طب الأعصاب",
    pediatrics: "طب الأطفال",
    orthopedics: "جراحة العظام",
    dermatology: "الأمراض الجلدية",
    generalMedicine: "الطب العام",
    surgery: "الجراحة",
    oncology: "الأورام",
    registrationDate: "تاريخ التسجيل",
    headDoctor: "رئيس القسم",
    serviceName: "اسم الخدمة",
    prescriptionDate: "تاريخ الوصفة",
    all: "الكل",
    fillAllFields: "يرجى ملء جميع الحقول",
    personalInformation: "المعلومات الشخصية",
    professionalInformation: "المعلومات المهنية",
    contactInformation: "معلومات الاتصال",
    serviceInformation: "معلومات الخدمة",
    appointmentInformation: "معلومات الموعد",
    prescriptionInformation: "معلومات الوصفة",
    participants: "المشاركون",
    statistics: "إحصائيات",
    lastAppointment: "آخر موعد",
    upcoming: "القادمة",
    dashboardReport: "تقرير لوحة القيادة",
    keyMetrics: "المؤشرات الرئيسية",
    topServices: "أفضل الخدمات",
    topSpecialties: "أفضل التخصصات",
    id: "المعرّف"
  },
  ro: {
    dashboard: "Tablou de bord",
    patients: "Pacienți",
    doctors: "Medici",
    services: "Servicii",
    appointments: "Programări",
    prescriptions: "Rețete",
    logout: "Deconectare",
    hospital: "Spital",
    backoffice: "Backoffice",
    reset: "Resetare",
    search: "Căutare...",
    export: "Export",
    add: "Adaugă",
    firstName: "Prenume",
    lastName: "Nume",
    email: "Email",
    phone: "Telefon",
    bloodGroup: "Grupa de sânge",
    actions: "Acțiuni",
    view: "Vizualizează",
    edit: "Editează",
    delete: "Șterge",
    noPatients: "Nu au fost găsiți pacienți.",
    showing: "Afișare",
    to: "până la",
    of: "din",
    addPatient: "Adaugă pacient",
    editPatient: "Editează pacient",
    save: "Salvează",
    cancel: "Anulează",
    patientDetails: "Detalii pacient",
    exportCSV: "Export CSV",
    exportPDF: "Export PDF",
    generatedOn: "Generat la",
    pdfLibNotLoaded: "Bibliotecile pentru export PDF nu sunt încărcate.",
    exportNotAvailable: "Export indisponibil",
    welcome: "Bine ai revenit",
    signIn: "Autentifică-te pentru a accesa tabloul de bord",
    username: "Utilizator",
    password: "Parolă",
    login: "Autentificare",
    demo: "Demo: admin / admin",
    patientsByService: "Pacienți pe servicii",
    appointmentsByDay: "Programări pe zile",
    appointmentsEvolution: "Evoluția programărilor (ultimele 7 zile)",
    appointmentsByStatus: "Programări după status",
    doctorsBySpecialty: "Medici pe specialități",
    totalPatients: "Total pacienți",
    totalDoctors: "Total medici",
    totalAppointments: "Total programări",
    totalServices: "Total servicii",
    totalPrescriptions: "Total rețete",
    scheduled: "Programat",
    completed: "Finalizat",
    cancelled: "Anulat",
    dateOfBirth: "Data nașterii",
    gender: "Gen",
    address: "Adresă",
    service: "Serviciu",
    selectService: "Selectează un serviciu",
    male: "Masculin",
    female: "Feminin",
    fullName: "Nume complet",
    confirmDelete: "Sigur dorești să ștergi acest pacient?",
    confirmDeleteDoctor: "Sigur dorești să ștergi acest medic?",
    confirmDeleteService: "Sigur dorești să ștergi acest serviciu?",
    confirmDeleteAppointment: "Sigur dorești să ștergi această programare?",
    confirmDeletePrescription: "Sigur dorești să ștergi această rețetă?",
    specialty: "Specialitate",
    noDoctors: "Nu au fost găsiți medici.",
    name: "Nume",
    description: "Descriere",
    noServices: "Nu au fost găsite servicii.",
    date: "Data",
    time: "Ora",
    status: "Status",
    patient: "Pacient",
    doctor: "Medic",
    noAppointments: "Nu au fost găsite programări.",
    medications: "Medicamente",
    dosage: "Dozaj",
    duration: "Durată",
    noPrescriptions: "Nu au fost găsite rețete.",
    unknown: "Necunoscut",
    all: "Toate",
    selectDoctor: "Selectează medic",
    selectPatient: "Selectează pacient",
    entries: "înregistrări",
    previous: "Anterior",
    next: "Următor",
    filter: "Filtru",
    details: "Detalii",
    close: "Închide",
    confirm: "Confirmă",
    noData: "Nu există date",
    total: "Total",
    fillAllFields: "Te rugăm să completezi toate câmpurile",
    createdSuccessfully: "Creat cu succes",
    updatedSuccessfully: "Actualizat cu succes",
    deletedSuccessfully: "Șters cu succes",
    deleteFailed: "Ștergerea a eșuat",
    addDoctor: "Adaugă medic",
    addAppointment: "Adaugă programare",
    addService: "Adaugă serviciu",
    addPrescription: "Adaugă rețetă",
    editDoctor: "Editează medic",
    editAppointment: "Editează programare",
    editService: "Editează serviciu",
    editPrescription: "Editează rețetă",
    doctorDetails: "Detalii medic",
    appointmentDetails: "Detalii programare",
    serviceDetails: "Detalii serviciu",
    prescriptionDetails: "Detalii rețetă",
    personalInformation: "Informații personale",
    professionalInformation: "Informații profesionale",
    contactInformation: "Informații de contact",
    serviceInformation: "Informații serviciu",
    appointmentInformation: "Informații programare",
    prescriptionInformation: "Informații rețetă",
    participants: "Participanți",
    statistics: "Statistici",
    registrationDate: "Data înregistrării",
    lastAppointment: "Ultima programare",
    upcoming: "Următoarele",
    headDoctor: "Medic șef",
    dashboardReport: "Raport tablou de bord",
    keyMetrics: "Indicatori cheie",
    topServices: "Top servicii",
    topSpecialties: "Top specialități",
    id: "ID"
  }
};

let currentLang = localStorage.getItem('hospital_lang') || "en";

function setLanguage(lang) {
  if (translations[lang]) {
    currentLang = lang;
    localStorage.setItem('hospital_lang', lang);
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
  }
}

function t(key) {
  const langTable = translations[currentLang] || {};
  const enTable = translations.en || {};
  return langTable[key] || enTable[key] || key;
}

function getCurrentLang() {
  return currentLang;
}

// Initialize on load
setLanguage(currentLang);

const languages = [
  { code: "en", label: "English", flag: "https://flagcdn.com/w40/gb.png", dir: "ltr" },
  { code: "fr", label: "Français", flag: "https://flagcdn.com/w40/fr.png", dir: "ltr" },
  { code: "ro", label: "Română", flag: "https://flagcdn.com/w40/ro.png", dir: "ltr" },
  { code: "ar", label: "العربية", flag: "https://flagcdn.com/w40/ma.png", dir: "rtl" },
];
window.App = window.App || {};
App.Services = App.Services || {};
App.Services.I18n = { t, setLanguage, getCurrentLang, languages };
window.t = t;
window.setLanguage = setLanguage;
window.getCurrentLang = getCurrentLang;
window.languages = languages;
})();
